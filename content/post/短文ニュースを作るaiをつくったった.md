+++
title = "短文ニュースを作るAIをつくったった"
date = 2020-06-13T00:24:00Z
updated = 2020-06-29T19:06:29Z
tags = ["技術系"]
blogimport = true 
[author]
	name = "サブカル科学研究会"
	uri = "https://draft.blogger.com/profile/00849312168396849001"
+++

<body><div class="markdown-body"><p>目次</p><ul><li><a href='#短文ニュースを作るAIをつくったった概要'>短文ニュースを作るAIをつくったった概要</a></li><li><a href='#前振り'>前振り</a></li><li><a href='#論文調査'>論文調査</a></li><li><a href='#実験'>実験</a><ul><li><a href='#データ'>データ</a></li><li><a href='#モデル'>モデル</a></li><li><a href='#開発環境'>開発環境</a></li><li><a href='#結果'>結果</a></li><li><a href='#感想'>感想</a></li></ul></li><li><a href='#考察'>考察</a></li><li><a href='#まとめ'>まとめ</a></li></ul> <h1 id="短文ニュースを作るAIをつくったった" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">短文ニュースを作るAIをつくったった<a href="#短文ニュースを作るAIをつくったった" title="短文ニュースを作るAIをつくったった"><i class="fas fa-link ml-1" style="display:none;"></i></a></h1><h2 id="短文ニュースを作るAIをつくったった概要" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">短文ニュースを作るAIをつくったった概要<a href="#短文ニュースを作るAIをつくったった概要" title="短文ニュースを作るAIをつくったった概要"><i class="fas fa-link ml-1" style="display:none;"></i></a></h2><p>深層学習を用いた機械翻訳モデルを用いて、ニュース本文からタイトルを自動生成するモデルの学習に成功しました。</p><h2 id="前振り" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">前振り<a href="#前振り" title="前振り"><i class="fas fa-link ml-1" style="display:none;"></i></a></h2><p>以前にネットニュース向けに、原稿からタイトルを自動で作れないか？という案件に携わることがありました。</p><p>取り組むにあたり、既存の手法について調べてました。</p><p>すると朝日新聞がすでに似たような技術に着手していることが分かりました。</p><p><a href="https://prtimes.jp/main/html/rd/p/000000809.000009214.html">電車内の短文ニュース向け要約を自動化、９０分が１分に</a></p><p>まあ、朝日新聞は有料で文章要約APIを公開しています。</p><p>朝日新聞のお陰で、タイトル生成は技術的に実現可能なことが分かりました。 そこで自分でも自動タイトル生成モデルを作ってみることにしました。</p><p>技術的な詳細については、流石に商売の種なのか、 関連するリンクを漁ってみても有用な情報は見当たりませんでした。</p><p>同じようなニュースっぽい記事が見つかるばかりである。</p><p>そこで論文ベースでの調査に切り替えたところ、参考になりそうな情報が手に入りました。</p><h2 id="論文調査" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">論文調査<a href="#論文調査" title="論文調査"><i class="fas fa-link ml-1" style="display:none;"></i></a></h2><p>ニュース記事から関連リンクを調べても技術的な詳細には踏み込めませんでした。</p><p>そこで調査の範囲を論文にまで広げることにしました。</p><p>実用のレベルに達している技術であれば、 当然のことながら研究段階のレベルはとうの昔に過ぎている筈です。</p><p>英語論文まで調査範囲を広げれば、実装のために使える情報が得られるでしょう。</p><p>そして研究論文は、 特に情報技術系統はGoogleScholarで検索すればPDFが容易にヒットする時代です。</p><p>個人的にはGoogleScholarよりも<a href="https://www.semanticscholar.org/">semantic scholar</a>の方が関連ワードや引用元へのアクセスが容易いのでこちらを主に利用してます。</p><p>自分が詳しくない分野について有効な検索ワードの絞り込み自体が一つの難所なのですが、semantic scholar のおかげでそのハードルを下げることができました。</p><p>適当に&quot;自然言語処理+要約&quot;あたりでサクサクと検索したところ、日本語情報では</p><p><a href="https://research-lab.yahoo.co.jp/nlp/20180326_kobayashi.html">複数エンコーダを用いたヤフートピックス見出し候補生成</a></p><p><a href="https://www.jstage.jst.go.jp/article/jkg/68/12/68_591/_pdf/-char/ja">朝日新聞社メディアラボの人工知能研究の取り組み</a></p><p>などが見つかりました。</p><p>要点としては、言語モデルに機械翻訳をさせる要領で、 ニュース本文とタイトルの対を学習させるというものです。</p><p>モデルはニュース本文からタイトルを生成するように学習をします。</p><p>さらに文献調査を進めたところ、 研究の方向性はタイトルの生成から、 そこに文字数の制約を設けるところまで至っていることがわかりました。</p><p>これはかなり実応用を意識した問題設定のようです。</p><p>文字数の制約という問題設定は表意文字の文化圏で強く顕在化しており、 英語論文は見つけられませんでした。</p><p>そうとなれば後は、 教師データを集めて、モデルを記述し、計算機にかけるだけです。</p><h2 id="実験" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">実験<a href="#実験" title="実験"><i class="fas fa-link ml-1" style="display:none;"></i></a></h2><h3 id="データ" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">データ<a href="#データ" title="データ"><i class="fas fa-link ml-1" style="display:none;"></i></a></h3><p>教師データはニュースサイトをスクレイピングし、約二万対のニュース本文とタイトルを用意しました。</p><h3 id="モデル" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">モデル<a href="#モデル" title="モデル"><i class="fas fa-link ml-1" style="display:none;"></i></a></h3><p>モデルはAlbertを参考に多段transformerを用いました。</p><p>encoderーdecoderモデルです。</p><p>AlbertはBERTからパラメータ数を効率化したモデルです。同じtransformerの層を繰り返し経由することで、モデルサイズの削減を行っています。 詳しくは<a href="https://ai-scholar.tech/articles/treatise/albert-ai-227">BERTはまだまだ進化する！軽くて強いALBERTが登場！</a>を参照してください。</p><p>またencoderーdecoderモデルを採用した理由としては、ようやくモデルであるPEGASUS、BARTなどが同様の構造を採用しているからです。</p><p>今回のモデルは深層学習系のattenntionモデルのため、 学習にはGPUやTPUを必要となります。</p><p>元論文と同様にRNN系のモデルを用いてもいいのですが、 最近の流行はtransformer系統なのでこちらを用いました。</p><p>個人的にもtranformerモデルの方が扱いに親しみが持てます。</p><p>文献をいくつか読んだ限りでは計算効率や性能面もtransformer系統の方がよさそうでした。</p><h3 id="開発環境" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">開発環境<a href="#開発環境" title="開発環境"><i class="fas fa-link ml-1" style="display:none;"></i></a></h3><p>環境の良さからpython-pytorchを用いた。</p><p>すでに深層学習モデルの基本的なコンポーネントや道具が整備されており、車輪の再発明をせずに済みます。また記述が楽なのでプロトタイプに向いています。</p><h3 id="結果" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">結果<a href="#結果" title="結果"><i class="fas fa-link ml-1" style="display:none;"></i></a></h3><p>GPU 11GB✖️2✖️5days で途中経過を観察しました。</p><p>おそらく数時間程度で出力結果は収束していました。</p><p>この問題の評価の難しいところとして、汎化性能の評価方法が挙げられます。</p><p>文章の自然さを評価する方法については、2020年時点ではクラウドソーシングを使った人力での採点が最も人間の感性に近いとされており、自動採点はホットなトピックです。</p><p>そのため、今回の結果の評価には私自身の目視での確認を採用しました。</p><p>結果としては、それなりに見られるものを出力するところまでは至りました。</p><h3 id="感想" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">感想<a href="#感想" title="感想"><i class="fas fa-link ml-1" style="display:none;"></i></a></h3><p>生成文の中にいくつかの場所で不自然なものに置き換わっていたり、人間からすると不思議な間違い方をします。</p><p>しかし、出力結果と本文を読めば、後は素人でも多少の修正を加えるだけでも実用に耐えるでしょう。</p><h2 id="考察" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">考察<a href="#考察" title="考察"><i class="fas fa-link ml-1" style="display:none;"></i></a></h2><p>トークンごとに意味ベクトルを学習させると、さらに結果が安定しました。</p><p>企業名や固有名詞に誤りが含まれるのは、モデルの損失関数からすると些細な間違いだが、人間からすると大きな間違いとして認識します。</p><p>このような間違いかたは頻発していました。</p><p>この点においては教師データの量を増やすか、コピーメカニズムをモデルに組み込むかのどちらかで対処するのが良いでしょう。</p><p>入力文中の価格や年度といった数字に対しては非常に脆弱であることが分かりました。</p><p>数字に該当する部分には数字が出力されますが、異なる数字であることが殆どでした。</p><p>それは数字の意味を把握するための機構がモデルに備わっていないので仕方がないといえます。</p><p>質疑応答システムに関する研究では、 transformer系統の機構とは別に、 数字を扱うための別の機構を加えて一つの大きなシステムを組み上げる手法がリーダーボードの上位を占めていたので、この弱点は既知のものです。</p><p>しかし、まだスマートな解決方法が見つかっていないのが正直なところです。</p><p><a href="https://leaderboard.allenai.org/drop/submissions/public">AI2 Leaderboard</a></p><h2 id="まとめ" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">まとめ<a href="#まとめ" title="まとめ"><i class="fas fa-link ml-1" style="display:none;"></i></a></h2><p>文章を書くのも、要約するのも同じようなものとして深層学習の文脈では扱える。</p><p>そして深層学習に共通する課題として教師データと学習資源の確保は必須だ。</p><p>しかし、その点を解決できればそれなり以上の結果も得られる。</p></div></body>
