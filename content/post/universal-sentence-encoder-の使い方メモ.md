+++
title = "Universal Sentence Encoder の使い方メモ"
date = 2020-06-22T18:29:00Z
updated = 2020-10-26T18:40:06Z
tags = ["技術系"]
blogimport = true 
[author]
	name = "サブカル科学研究会"
	uri = "https://draft.blogger.com/profile/00849312168396849001"
+++

<p name="yHMmc" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;">Universal Sentence Encoder を使って文書のベクトルが得られる。</p><nav class="o-indexHeading" data-v-7e649226="" data-v-fbb1ba18="" style="-webkit-text-size-adjust: 100%; background-color: #f7f9f9; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; margin: 36px 0px; padding: 16px;"><h4 class="o-indexHeading__title is-open" data-v-7e649226="" style="box-sizing: inherit; color: #787c7b; font-family: inherit; font-size: 14px; margin: 0px; padding: 0px 0px 0px 16px; position: relative;"><button aria-label="arrowdropdown" class="o-indexHeading__dropdown a-icon a-icon--arrowdropdown a-icon--size_medium" data-v-7e649226="" style="background-color: transparent; border-bottom-left-radius: 24px; border-bottom-right-radius: 24px; border-top-left-radius: 24px; border-top-right-radius: 24px; border: none; box-sizing: inherit; color: inherit; cursor: pointer; font-family: icon; font-size: 24px; font-stretch: inherit; font-style: inherit; font-variant-caps: inherit; height: 24px; left: -8px; line-height: 1; margin: 0px; overflow: visible; padding-left: 0px; padding-right: 0px; position: absolute; top: -1px; touch-action: manipulation; transform: rotate(0deg); vertical-align: top; width: 24px;" type="button"></button>目次</h4><div class="o-indexHeading__body" data-v-7e649226="" style="box-sizing: inherit; margin: 0px; padding: 0px;"><ol class="o-indexHeading__list" data-v-7e649226="" style="box-sizing: inherit; list-style: none; margin: 0px; padding: 0px;"><li class="o-indexHeading__item" data-v-7e649226="" style="border-top-style: none; box-sizing: inherit; font-size: 14px; list-style-type: none; margin: 0px; padding: 20px 0px 8px;"><a class="o-indexHeading__link" data-v-7e649226="" style="background-color: transparent; box-sizing: inherit; color: #787c7b; cursor: pointer; display: block; margin: 0px; padding: 0px; text-decoration: underline;">特徴</a></li><li class="o-indexHeading__item" data-v-7e649226="" style="border-top-color: rgb(230, 230, 230); border-top-style: solid; border-top-width: 1px; box-sizing: inherit; font-size: 14px; list-style-type: none; margin: 0px; padding: 8px 0px;"><a class="o-indexHeading__link" data-v-7e649226="" style="background-color: transparent; box-sizing: inherit; color: #787c7b; cursor: pointer; display: block; margin: 0px; padding: 0px; text-decoration: underline;">使い道</a></li><li class="o-indexHeading__item" data-v-7e649226="" style="border-top-color: rgb(230, 230, 230); border-top-style: solid; border-top-width: 1px; box-sizing: inherit; font-size: 14px; list-style-type: none; margin: 0px; padding: 8px 0px;"><a class="o-indexHeading__link" data-v-7e649226="" style="background-color: transparent; box-sizing: inherit; color: #787c7b; cursor: pointer; display: block; margin: 0px; padding: 0px; text-decoration: underline;">使い方</a></li></ol></div></nav><h3 name="kD2b0" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-feature-settings: &quot;palt&quot;; font-size: 20px; letter-spacing: 0.04em; line-height: 1.75; margin: 36px 0px -20px; padding: 0px;">特徴</h3><p name="K75UC" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;">多言語に対応している。</p><p name="Oh93a" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;">日本語にも対応している。</p><p name="eVVD3" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;"><br style="box-sizing: inherit; margin: 0px; padding: 0px;" /></p><p name="AQlq3" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;">日本語の文章をベクトルで扱える</p><h3 name="axF8y" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-feature-settings: &quot;palt&quot;; font-size: 20px; letter-spacing: 0.04em; line-height: 1.75; margin: 36px 0px -20px; padding: 0px;">使い道</h3><p name="VBQ0i" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;">クラスタリング、類似度の計算、特徴量の抽出</p><h3 name="BDNJu" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-feature-settings: &quot;palt&quot;; font-size: 20px; letter-spacing: 0.04em; line-height: 1.75; margin: 36px 0px -20px; padding: 0px;">使い方</h3><p name="f8Hc1" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;">準備として以下のコマンドを実行する。</p><pre class="p-textNoteCode" data-name="preCode" name="Djg2Z" style="-webkit-text-size-adjust: 100%; background-color: #282c34; box-sizing: inherit; color: white; font-size: 12px; line-height: 18px; margin: 32px -16px; padding: 24px; white-space: pre-wrap;"><code class="p-textNoteCode__main hljs" data-name="code" style="-webkit-overflow-scrolling: touch; box-sizing: inherit; display: block; line-height: 18px; margin: 0px; overflow-x: auto; padding: 0.5em; white-space: pre; word-wrap: normal;">pip install tensorflow tensorflow_hub numpy tf_sentencepiece&nbsp;<br /></code></pre><p name="PdOv1" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;">学習済みのモデルが公開されている。</p><p name="2kIXa" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;">具体的な利用方法は以下のpythonの記述を参照</p><pre class="p-textNoteCode" data-name="preCode" name="dh6hR" style="-webkit-text-size-adjust: 100%; background-color: #282c34; box-sizing: inherit; color: white; font-size: 12px; line-height: 18px; margin: 32px -16px; padding: 24px; white-space: pre-wrap;"><code class="p-textNoteCode__main hljs swift" data-name="code" style="-webkit-overflow-scrolling: touch; box-sizing: inherit; display: block; line-height: 18px; margin: 0px; overflow-x: auto; padding: 0.5em; white-space: pre; word-wrap: normal;"><span class="hljs-keyword" style="box-sizing: inherit; color: #c678dd; margin: 0px; padding: 0px;">import</span> tensorflow_hub as hub<br /><span class="hljs-keyword" style="box-sizing: inherit; color: #c678dd; margin: 0px; padding: 0px;">import</span> numpy as np<br /># <span class="hljs-keyword" style="box-sizing: inherit; color: #c678dd; margin: 0px; padding: 0px;">for</span> avoiding error<br /><span class="hljs-keyword" style="box-sizing: inherit; color: #c678dd; margin: 0px; padding: 0px;">import</span> ssl<br />ssl._create_default_https_context = ssl._create_unverified_context<br /><br /></code></pre><pre class="p-textNoteCode" data-name="preCode" name="RsxGA" style="-webkit-text-size-adjust: 100%; background-color: #282c34; box-sizing: inherit; color: white; font-size: 12px; line-height: 18px; margin: 32px -16px; padding: 24px; white-space: pre-wrap;"><code class="p-textNoteCode__main hljs python" data-name="code" style="-webkit-overflow-scrolling: touch; box-sizing: inherit; display: block; line-height: 18px; margin: 0px; overflow-x: auto; padding: 0.5em; white-space: pre; word-wrap: normal;"><span class="hljs-keyword" style="box-sizing: inherit; color: #c678dd; margin: 0px; padding: 0px;">import</span> ssl<br />ssl._create_default_https_context = ssl._create_unverified_context<br /><span class="hljs-function" style="box-sizing: inherit; margin: 0px; padding: 0px;"><span class="hljs-keyword" style="box-sizing: inherit; color: #c678dd; margin: 0px; padding: 0px;">def</span> <span class="hljs-title" style="box-sizing: inherit; color: #61aeee; margin: 0px; padding: 0px;">cos_sim</span><span class="hljs-params" style="box-sizing: inherit; margin: 0px; padding: 0px;">(v1, v2)</span>:</span><br />   <span class="hljs-keyword" style="box-sizing: inherit; color: #c678dd; margin: 0px; padding: 0px;">return</span> np.dot(v1, v2) / (np.linalg.norm(v1) * np.linalg.norm(v2))<br /><br />embed = hub.load(<span class="hljs-string" style="box-sizing: inherit; color: #98c379; margin: 0px; padding: 0px;">"https://tfhub.dev/google/universal-sentence-encoder-multilingual/3"</span>)<br /><br />texts = [<span class="hljs-string" style="box-sizing: inherit; color: #98c379; margin: 0px; padding: 0px;">"昨日、お笑い番組を見た。"</span>, <span class="hljs-string" style="box-sizing: inherit; color: #98c379; margin: 0px; padding: 0px;">"昨夜、テレビで漫才をやっていた。"</span>, <span class="hljs-string" style="box-sizing: inherit; color: #98c379; margin: 0px; padding: 0px;">"昨日、公園に行った。"</span>, <span class="hljs-string" style="box-sizing: inherit; color: #98c379; margin: 0px; padding: 0px;">"I saw a comedy show last night."</span>, <span class="hljs-string" style="box-sizing: inherit; color: #98c379; margin: 0px; padding: 0px;">"Yesterday, I went to the park."</span>]<br />vectors = embed(texts)<br /><br />print(texts[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">0</span>], texts[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">1</span>], cos_sim(vectors[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">0</span>], vectors[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">1</span>]), sep=<span class="hljs-string" style="box-sizing: inherit; color: #98c379; margin: 0px; padding: 0px;">"\t"</span>)<br />print(texts[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">0</span>], texts[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">2</span>], cos_sim(vectors[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">0</span>], vectors[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">2</span>]), sep=<span class="hljs-string" style="box-sizing: inherit; color: #98c379; margin: 0px; padding: 0px;">"\t"</span>)<br />print(texts[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">0</span>], texts[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">3</span>], cos_sim(vectors[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">0</span>], vectors[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">3</span>]), sep=<span class="hljs-string" style="box-sizing: inherit; color: #98c379; margin: 0px; padding: 0px;">"\t"</span>)<br />print(texts[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">0</span>], texts[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">4</span>], cos_sim(vectors[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">0</span>], vectors[<span class="hljs-number" style="box-sizing: inherit; color: #d19a66; margin: 0px; padding: 0px;">4</span>]), sep=<span class="hljs-string" style="box-sizing: inherit; color: #98c379; margin: 0px; padding: 0px;">"\t"</span></code></pre><p name="kHD6h" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;">詳細は以下のリンクを参照</p><p name="yHMmc" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;"></p><figure data-identifier="null" embedded-content-key="emb66c45a6eea56" embedded-service="external-article" name="JBIr8" style="-webkit-text-size-adjust: 100%; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; margin: 30px 0px; overflow: hidden; padding: 0px; position: relative;"><div data-name="embedContainer" style="box-sizing: inherit; margin: 0px; padding: 0px;"><div data-embed-service="external-article" style="box-sizing: inherit; margin: 0px; padding: 0px;"><div class="external-article-widget" style="border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgb(230, 230, 230); box-sizing: inherit; display: table; margin: 0px; padding: 0px; width: 343px;"><a href="https://qiita.com/kenta1984/items/9613da23766a2578a27a" rel="nofollow" style="-webkit-box-direction: normal; -webkit-box-flex: 1; -webkit-box-orient: vertical; box-sizing: inherit; color: inherit; cursor: pointer; display: table-cell; flex-direction: column; flex: 1 1 0%; margin: 0px; padding: 16px; text-decoration: none; vertical-align: middle; width: 221px;" target="_blank"><span class="external-article-widget-title" style="-webkit-box-orient: vertical; -webkit-line-clamp: 2; box-sizing: inherit; display: -webkit-box; font-size: 14px; font-weight: 700; margin: 0px 0px 8px; max-height: 2.8em; overflow: hidden; padding: 0px; word-break: break-all;">Universal Sentence Encoderを日本語で試す - Qiita</span><span class="external-article-widget-description" style="-webkit-box-orient: vertical; -webkit-line-clamp: 2; box-sizing: inherit; color: #787c7b; display: -webkit-box; font-size: 12px; line-height: 1.5; margin: 0px 0px 4px; max-height: 3em; overflow: hidden; padding: 0px; word-break: break-all;">Universal Sentence Encoderとは その名の通り、文をエンコード、すなわち文をベクトル化する手</span><span class="external-article-widget-url" style="box-sizing: inherit; display: block; font-size: 12px; line-height: 1.5; margin: 0px; padding: 0px;">qiita.com</span></a><a class="external-article-widget-image" href="https://qiita.com/kenta1984/items/9613da23766a2578a27a" rel="nofollow" style="-webkit-box-direction: normal; -webkit-box-flex: 0; -webkit-box-orient: vertical; background-image: url(&quot;https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?blend=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26amp%3Bw%3D840%26amp%3Bh%3D500%26amp%3Btxt%3D%2540kenta1984%26amp%3Btxt-color%3D%2523333%26amp%3Btxt-font%3DAvenir-Black%26amp%3Btxt-size%3D45%26amp%3Btxt-align%3Dright%252Cbottom%26amp%3Bs%3Da29e708119dd41758137d02504eab37d&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;ixlib=rb-1.2.2&amp;mark=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26amp%3Bw%3D840%26amp%3Bh%3D380%26amp%3Btxt%3DUniversal%2520Sentence%2520Encoder%25E3%2582%2592%25E6%2597%25A5%25E6%259C%25AC%25E8%25AA%259E%25E3%2581%25A7%25E8%25A9%25A6%25E3%2581%2599%26amp%3Btxt-color%3D%2523333%26amp%3Btxt-font%3DAvenir-Black%26amp%3Btxt-size%3D54%26amp%3Btxt-clip%3Dellipsis%26amp%3Btxt-align%3Dcenter%252Cmiddle%26amp%3Bs%3D05a0ca70e7a2728eae7bc363e741df18&amp;mark-align=center%2Cmiddle&amp;s=fc23ee5ea36ea02b5780505be993260d&amp;w=1200&quot;); background-position: 50% 50%; background-size: cover; border-bottom-left-radius: 0px; border-bottom-right-radius: 3px; border-left-color: rgb(242, 242, 242); border-left-style: solid; border-left-width: 1px; border-top-left-radius: 0px; border-top-right-radius: 3px; box-sizing: inherit; color: inherit; cursor: pointer; display: table-cell; flex-direction: column; flex: 0 1 0%; height: 120px; margin: 0px; min-width: 120px; padding: 16px; text-decoration: none; vertical-align: middle; width: 120px;" target="_blank"></a></div></div></div></figure><p name="nIf7I" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;">得られた分散表現の利用方法は以下を参照</p><p name="yHMmc" style="-webkit-text-size-adjust: 100%; box-sizing: inherit; caret-color: rgb(34, 34, 34); color: #222222; font-size: 16px; line-height: 30px; margin: 30px 0px; padding: 0px;"></p> <blockquote class="embedly-card"><h4><a href="https://www.subcul-science.com/2020/06/blog-post_54.html">文書分類問題の応用はなにがある？</a></h4><p>機械学習について勉強したけど、その使い道が分からん！ってなってないですか？  </p></blockquote> <script async src="//cdn.embedly.com/widgets/platform.js" charset="UTF-8"></script><!-- START MoshimoAffiliateEasyLink --><script type="text/javascript">(function(b,c,f,g,a,d,e){b.MoshimoAffiliateObject=a; b[a]=b[a]||function(){arguments.currentScript=c.currentScript ||c.scripts[c.scripts.length-2];(b[a].q=b[a].q||[]).push(arguments)}; c.getElementById(a)||(d=c.createElement(f),d.src=g, d.id=a,e=c.getElementsByTagName("body")[0],e.appendChild(d))}) (window,document,"script","//dn.msmstatic.com/site/cardlink/bundle.js","msmaflink"); msmaflink({"n":"自然言語処理の基本と技術","b":"","t":"","d":"https:\/\/m.media-amazon.com","c_p":"","p":["\/images\/I\/51V9d2v9Z9L.jpg"],"u":{"u":"https:\/\/www.amazon.co.jp\/dp\/B01CGAPLLO","t":"amazon","r_v":""},"aid":{"amazon":"2220302","rakuten":"2220301","yahoo":"2220303"},"eid":"Vza6T","s":"s"}); </script><div id="msmaflink-Vza6T">リンク</div><!-- MoshimoAffiliateEasyLink END -->
