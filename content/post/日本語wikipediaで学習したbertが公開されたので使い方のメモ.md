+++
title = "æ—¥æœ¬èªWikipediaã§å­¦ç¿’ã—ãŸBERTãŒå…¬é–‹ã•ã‚ŒãŸã®ã§ä½¿ã„æ–¹ã®ãƒ¡ãƒ¢"
date = 2020-06-17T07:34:00Z
updated = 2020-12-04T13:50:42Z
tags = ["æŠ€è¡“ç³»"]
blogimport = true 
[author]
	name = "ã‚µãƒ–ã‚«ãƒ«ç§‘å­¦ç ”ç©¶ä¼š"
	uri = "https://draft.blogger.com/profile/00849312168396849001"
+++

<head>      <meta charset="utf-8">      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/monokai-sublime.min.css" integrity="sha256-kTdkFYZP3TqSvlJAUiZ6/s5L2xu4xsdU9eYMWsKOk74=" crossorigin="anonymous">			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css" integrity="sha256-HbgiGHMLxHZ3kkAiixyvnaaZFNjNWLYKD/QG6PWaQPc=" crossorigin="anonymous">			<link rel="stylesheet" href="/css/guest.bundle.css?v=0.13.0"><style type="text/css">      .markdown-body { 			  box-sizing: border-box; 			  min-width: 200px; 			  max-width: 980px; 			  margin: 0 auto; 			  padding: 45px; 			} 			.markdown-body pre { 			  background: #23241f; 			} 			.markdown-body strong, 			.markdown-body h1, 			.markdown-body h2, 			.markdown-body h3, 			.markdown-body h4, 			.markdown-body h5 { 			  font-weight: 700; 			} 			@media (max-width: 767px) { 			  .markdown-body { 			    padding: 15px; 			  } 			}</style><script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><title>æ—¥æœ¬èªWikipediaã§å­¦ç¿’ã—ãŸBERTãŒå…¬é–‹ã•ã‚ŒãŸã®ã§ä½¿ã„æ–¹ã®ãƒ¡ãƒ¢</title></head><body><div class="markdown-body"><h1 id="æ—¥æœ¬èªWikipediaã§å­¦ç¿’ã—ãŸBERTãŒå…¬é–‹ã•ã‚ŒãŸã®ã§ä½¿ã„æ–¹ã®ãƒ¡ãƒ¢" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">æ—¥æœ¬èªWikipediaã§å­¦ç¿’ã—ãŸBERTãŒå…¬é–‹ã•ã‚ŒãŸã®ã§ä½¿ã„æ–¹ã®ãƒ¡ãƒ¢<a href="#æ—¥æœ¬èªWikipediaã§å­¦ç¿’ã—ãŸBERTãŒå…¬é–‹ã•ã‚ŒãŸã®ã§ä½¿ã„æ–¹ã®ãƒ¡ãƒ¢" title="æ—¥æœ¬èªWikipediaã§å­¦ç¿’ã—ãŸBERTãŒå…¬é–‹ã•ã‚ŒãŸã®ã§ä½¿ã„æ–¹ã®ãƒ¡ãƒ¢"><i class="fas fa-link ml-1" style="display:none;"></i></a></h1><ul><li><a href='#å‰æº–å‚™:mecabã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«'>å‰æº–å‚™:mecabã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li><li><a href='#transformersã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«'>transformersã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li><li><a href='#BERT_ã®åˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã®ä¾‹ã‚’å‚è€ƒã«ã—ã¾ã™ã€‚'>BERT ã®åˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã®ä¾‹ã‚’å‚è€ƒã«ã—ã¾ã™ã€‚</a></li><li><a href='#å¿œç”¨ç¯„å›²'>å¿œç”¨ç¯„å›²</a></li></ul> <p>huggingface ãŒBERTã®æ—¥æœ¬èªãƒ¢ãƒ‡ãƒ«ã‚’å…¬é–‹ã—ã¾ã—ãŸã€‚</p><p>æ—¥æœ¬èªãƒ¢ãƒ‡ãƒ«ã¯transformersã«å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚</p><p>ã—ã‹ã—ã€Mac ç’°å¢ƒã§å®Ÿéš›ã«å‹•ã‹ã™ã¾ã§ã«ã„ãã¤ã‹èº“ã„ãŸã®ã§ã€ãƒ¡ãƒ¢ã‚’æ®‹ã—ã¦ãŠãã¾ã™ã€‚</p><h2 id="å‰æº–å‚™:mecabã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">å‰æº–å‚™:mecabã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a href="#å‰æº–å‚™:mecabã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" title="å‰æº–å‚™:mecabã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"><i class="fas fa-link ml-1" style="display:none;"></i></a></h2><p>å½¢æ…‹ç´ è§£æã‚¨ãƒ³ã‚¸ãƒ³ã§ã‚ã‚‹mecabãŒ BERT ã®æ—¥æœ¬èªãƒ¢ãƒ‡ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹éš›ã«å¿…è¦ã«ãªã‚Šã¾ã™ã€‚ãŠãã‚‰ããƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãŒmecabã‚’è¦æ±‚ã™ã‚‹ä»•çµ„ã¿ã«ãªã£ã¦ã„ã¾ã™ã€‚</p><p>ä»¥ä¸‹ã®ã‚µã‚¤ãƒˆã‚’å‚è€ƒã«mecabã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p><p>Mecabã‚’Pythonã§ä½¿ã†ã¾ã§ - QiitaMecabã¨ã¯ å½¢æ…‹ç´ è§£æã‚¨ãƒ³ã‚¸ãƒ³ã§ã™ã€‚ å½¢æ…‹ç´ è§£æã«ã¤ã„ã¦ã¯ä»–ã®æ–¹ã®è¨˜äº‹ãŒã™ã”ãã‚ã‹ã‚Šã‚„ã™ã„ã®ã§å‰²æ„›ã—ã¾ã™ã€‚ ãªãŠ qiita.com</p><p>homebrew ã‚’åˆ©ç”¨ã—ã¦ã€Mecab ã¨ipadicã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p><pre><code>brew install mecab mecab-ipadic</code></pre><p>è¾æ›¸ã‚’æ›´æ–°ã™ã‚‹ãŸã‚ã«ã€é©å½“ãªè¾æ›¸ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</p><pre><code>git clone --depth 1 https://github.com/neologd/mecab-ipadic-neologd.git<br />./bin/install-mecab-ipadic-neologd -n -a</code></pre><p>python ã®mecabãƒ©ãƒƒãƒ‘ãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p><pre><code>pip install mecab-python3</code></pre><h2 id="transformersã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">transformersã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a href="#transformersã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" title="transformersã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"><i class="fas fa-link ml-1" style="display:none;"></i></a></h2><p><a href="https://github.com/huggingface/transformers">huggingface/transformers</a></p><p>å…¬å¼ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å¾“ã£ã¦transformersã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p><pre><code>pip install transformers</code></pre><h2 id="BERT_ã®åˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã®ä¾‹ã‚’å‚è€ƒã«ã—ã¾ã™ã€‚" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">BERT ã®åˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã®ä¾‹ã‚’å‚è€ƒã«ã—ã¾ã™ã€‚<a href="#BERT_ã®åˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã®ä¾‹ã‚’å‚è€ƒã«ã—ã¾ã™ã€‚" title="BERT_ã®åˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã®ä¾‹ã‚’å‚è€ƒã«ã—ã¾ã™ã€‚"><i class="fas fa-link ml-1" style="display:none;"></i></a></h2><p><a href="https://github.com/cl-tohoku/bert-japanese">clï½°tohoku</a></p><pre><code>import torch<br />from transformers.tokenization_bert_japanese import BertJapaneseTokenizer<br />from transformers.modeling_bert import BertForMaskedLM<br />tokenizer = BertJapaneseTokenizer.from_pretrained(&#39;bert-base-japanese-whole-word-masking</code></pre><p>bert-base-japanese-whole-word-maskingã¯å­¦ç¿’æ™‚ã«ç”¨ã„ãŸãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚ºã®æ–¹æ³•(å˜èªåŒºåˆ‡ã‚Šã‹æ–‡å­—åŒºåˆ‡ã‚Š)ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚</p><pre><code>model = BertForMaskedLM.from_pretrained(&#39;bert-base-japanese-whole-word-masking&#39;)</code></pre><p>ã‚¿ã‚¹ã‚¯ã«å¯¾å¿œã—ãŸBERTãƒ¢ãƒ‡ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚</p><p>ä»Šå›ã¯MLM(Masked Language Model )ã¨ãªã‚Šã¾ã™ã€‚ãƒã‚¹ã‚¯ãƒˆãƒ¼ã‚¯ãƒ³ãŒå­˜åœ¨ã™ã‚‹ä½ç½®ã«å…¥ã‚‹å˜èªã®ç¢ºç‡ã‚’è¿”ã—ã¾ã™ã€‚</p><pre><code>input_ids = tokenizer.encode(f&#39;&#39;&#39;<br />   é’è‘‰å±±ã§{tokenizer.mask_token}ã®ç ”ç©¶ã‚’ã—ã¦ã„ã¾ã™ã€‚<br />&#39;&#39;&#39;, return_tensors=&#39;pt&#39;)</code></pre><p>ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ã‚’åˆ©ç”¨ã—ã¦ã€ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å¯¾å¿œã™ã‚‹è¾æ›¸ç•ªå·ã«å¤‰æ›ã—ã¾ã™ã€‚</p><pre><code>print(input_ids)<br />print(tokenizer.convert_ids_to_tokens(input_ids[0].tolist()))</code></pre><p>idç•ªå·ã‚’å¯¾å¿œã™ã‚‹è¾æ›¸ã®ãƒˆãƒ¼ã‚¯ãƒ³ã«ç½®ãæ›ãˆã¾ã™ã€‚</p><pre><code>masked_index = torch.where(input_ids == tokenizer.mask_token_id)[1].tolist()[0]<br />print(masked_index)<br />result = model(input_ids)<br />pred_ids = result[0][:, masked_index].topk(5).indices.tolist()[0]<br />for pred_id in pred_ids:<br />   output_ids = input_ids.tolist()[0]<br />   output_ids[masked_index] = pred_id<br />   print(tokenizer.decode(output_ids))</code></pre><p>ãƒã‚¹ã‚¯ãƒˆãƒ¼ã‚¯ãƒ³ãŒå…¥ã£ã¦ã„ã‚‹ä½ç½®ã«å…¥ã‚‹ç¢ºç‡ãŒé«˜ã„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’k=5å€‹è¡¨ç¤ºã—ã¾ã™ã€‚</p><p>BERT ã®ãƒ¢ãƒ‡ãƒ«ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€å˜èªã®ç¢ºç‡ã ã‘ã§ãªãã€åˆ†æ•£è¡¨ç¾ã‚‚è¨ˆç®—ã§ãã¾ã™ã€‚</p><h2 id="å¿œç”¨ç¯„å›²" onmouseover="this.querySelector('a .fa-link').style.display='inline-block'" onmouseout="this.querySelector('a .fa-link').style.display='none'">å¿œç”¨ç¯„å›²<a href="#å¿œç”¨ç¯„å›²" title="å¿œç”¨ç¯„å›²"><i class="fas fa-link ml-1" style="display:none;"></i></a></h2><p>å˜èªã®åˆ†æ•£è¡¨ç¾ã®å¿œç”¨ç¯„å›²ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯</p><p><a href="https://www.subcul-science.com/2020/06/blog-post_54.html">æ–‡æ›¸åˆ†é¡å•é¡Œã®å¿œç”¨ã¯ä½•ãŒã‚ã‚‹ï¼Ÿ</a></p></div></body><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script><script type="text/javascript">hljs.initHighlightingOnLoad();</script><script>		  $(document).on("mouseover", "h1,h2,h3,h4,h5", function(e) { 		    $(e.currentTarget).find(".fa-link").text("ğŸ”—").show(); 		  }); 		  $(document).on("mouseout", "h1,h2,h3,h4,h5", function(e) { 		    $(e.currentTarget).find(".fa-link").hide(); 		  });</script> å‚è€ƒè³‡æ–™  æ©Ÿæ¢°å­¦ç¿’ãƒ»æ·±å±¤å­¦ç¿’ã«ã‚ˆã‚‹è‡ªç„¶è¨€èªå‡¦ç†å…¥é–€ã€€scikit-learnã¨TensorFlowã‚’ä½¿ã£ãŸå®Ÿè·µãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°  <div class="booklink-box" style="text-align:left;padding-bottom:20px;font-size:small;zoom: 1;overflow: hidden;"><div class="booklink-image" style="float:left;margin:0 15px 10px 0;"><a href="//af.moshimo.com/af/c/click?a_id=2220302&p_id=170&pc_id=185&pl_id=4062&s_v=b5Rz2P0601xu&url=https%3A%2F%2Fwww.amazon.co.jp%2Fexec%2Fobidos%2FASIN%2F4839966605" target="_blank" ><img src="" style="border: none;" /></a><img src="//i.moshimo.com/af/i/impression?a_id=2220302&p_id=170&pc_id=185&pl_id=4062" width="1" height="1" style="border:none;"></div><div class="booklink-info" style="line-height:120%;zoom: 1;overflow: hidden;"><div class="booklink-name" style="margin-bottom:10px;line-height:120%"><a href="//af.moshimo.com/af/c/click?a_id=2220302&p_id=170&pc_id=185&pl_id=4062&s_v=b5Rz2P0601xu&url=https%3A%2F%2Fwww.amazon.co.jp%2Fexec%2Fobidos%2FASIN%2F4839966605" target="_blank" ></a><img src="//i.moshimo.com/af/i/impression?a_id=2220302&p_id=170&pc_id=185&pl_id=4062" width="1" height="1" style="border:none;"><div class="booklink-powered-date" style="font-size:8pt;margin-top:5px;font-family:verdana;line-height:120%">posted with <a href="https://yomereba.com" rel="nofollow" target="_blank">ãƒ¨ãƒ¡ãƒ¬ãƒ</a></div></div><div class="booklink-detail" style="margin-bottom:5px;"></div><div class="booklink-link2" style="margin-top:10px;"><div class="shoplinkamazon" style="display:inline;margin-right:5px;background: url('//img.yomereba.com/yl.gif') 0 0 no-repeat;padding: 2px 0 2px 18px;white-space: nowrap;"><a href="//af.moshimo.com/af/c/click?a_id=2220302&p_id=170&pc_id=185&pl_id=4062&s_v=b5Rz2P0601xu&url=https%3A%2F%2Fwww.amazon.co.jp%2Fexec%2Fobidos%2FASIN%2F4839966605" target="_blank" >Amazonã§è³¼å…¥</a><img src="//i.moshimo.com/af/i/impression?a_id=2220302&p_id=170&pc_id=185&pl_id=4062" width="1" height="1" style="border:none;"></div><div class="shoplinkkindle" style="display:inline;margin-right:5px;background: url('//img.yomereba.com/yl.gif') 0 0 no-repeat;padding: 2px 0 2px 18px;white-space: nowrap;"><a href="//af.moshimo.com/af/c/click?a_id=2220302&p_id=170&pc_id=185&pl_id=4062&s_v=b5Rz2P0601xu&url=https%3A%2F%2Fwww.amazon.co.jp%2Fgp%2Fsearch%3Fkeywords%3D%26__mk_ja_JP%3D%2583J%2583%255E%2583J%2583i%26url%3Dnode%253D2275256051" target="_blank" >Kindleã§è³¼å…¥</a><img src="//i.moshimo.com/af/i/impression?a_id=2220302&p_id=170&pc_id=185&pl_id=4062" width="1" height="1" style="border:none;"></div><div class="shoplinkrakuten" style="display:inline;margin-right:5px;background: url('//img.yomereba.com/yl.gif') 0 -50px no-repeat;padding: 2px 0 2px 18px;white-space: nowrap;"><a href="//af.moshimo.com/af/c/click?a_id=2220301&p_id=56&pc_id=56&pl_id=637&s_v=b5Rz2P0601xu&url=http%3A%2F%2Fbooks.rakuten.co.jp%2Frb%2F16190713%2F" target="_blank" >æ¥½å¤©ãƒ–ãƒƒã‚¯ã‚¹ã§è³¼å…¥</a><img src="//i.moshimo.com/af/i/impression?a_id=2220302&p_id=170&pc_id=185&pl_id=4062" width="1" height="1" style="border:none;"></div><div class="shoplinkrakukobo" style="display:inline;margin-right:5px;background: url('//img.yomereba.com/yl.gif') 0 -50px no-repeat;padding: 2px 0 2px 18px;white-space: nowrap;"><a href="//af.moshimo.com/af/c/click?a_id=2220301&p_id=56&pc_id=56&pl_id=637&s_v=b5Rz2P0601xu&url=https%3A%2F%2Fbooks.rakuten.co.jp%2Frk%2F350e869d324d356eb91b3b52d00d0e36%2F" target="_blank" >æ¥½å¤©koboã§è³¼å…¥</a><img src="//i.moshimo.com/af/i/impression?a_id=2220301&p_id=56&pc_id=56&pl_id=637" width="1" height="1" style="border:none;"></div>	  <div class="shoplinkseven" style="display:inline;margin-right:5px;background: url('//img.yomereba.com/yl.gif') 0 -100px no-repeat;padding: 2px 0 2px 18px;white-space: nowrap;"><a href="//af.moshimo.com/af/c/click?a_id=2317554&p_id=932&pc_id=1188&pl_id=12456&s_v=b5Rz2P0601xu&url=http%3A%2F%2F7net.omni7.jp%2Fsearch%2F%3FsearchKeywordFlg%3D1%26keyword%3D9784839966607" target="_blank" >7netã§è³¼å…¥<imgÂ src="//i.moshimo.com/af/i/impression?a_id=2317554&p_id=932&pc_id=1188&pl_id=12456"Â width="1"Â height="1"Â style="border:none;"></a></div>            	  	  	  	      </div></div><div class="booklink-footer" style="clear: left"></div></div>
